# 육군 군수사령부 업무 도우미 - 아름이(ARMY)

## 📋 프로젝트 개요

육군 군수사령부 업무 도우미 "아름이(ARMY)"는 RAG(Retrieval-Augmented Generation) 기반의 지능형 문서 분석 시스템입니다. 군수 관련 문서를 업로드하고 임베딩하여 직원들이 효율적으로 업무 정보를 검색하고 질의응답을 받을 수 있도록 지원합니다.

## ✨ 주요 기능

### 🔐 역할 기반 접근 제어 (RBAC)
- **일반 사용자**: 문서 기반 질의응답만 가능
- **관리자**: 파일 업로드, 삭제, 벡터 DB 관리, 시스템 모니터링

### 📚 문서 관리
- **지원 형식**: PDF, DOCX, TXT 파일
- **파일 크기**: 최대 50MB
- **자동 처리**: 업로드 후 자동 임베딩 생성
- **선택적 임베딩**: 개별 파일 또는 전체 파일 임베딩 가능
- **상태 관리**: 임베딩 완료/대기 상태 실시간 표시

### 🤖 AI 기능
- **OpenAI API**: GPT-3.5-turbo 모델을 활용한 정확한 응답 생성
- **텍스트 임베딩**: text-embedding-3-large 모델 사용
- **Cloud Storage 벡터 저장소**: Google Cloud Storage 기반 벡터 DB로 안정적인 검색
- **청크 기반**: 효율적인 문서 분할 및 처리

### 🎨 사용자 인터페이스
- **통합 대시보드**: 시스템 상태, 문서 현황, 벡터 DB 정보를 한눈에
- **직관적인 파일 관리**: 드래그 앤 드롭 파일 업로드
- **실시간 상태 업데이트**: 임베딩 진행률 및 상태 표시
- **반응형 디자인**: 모바일 및 데스크톱 최적화

## 🛠 기술 스택

### 백엔드
- **Flask**: 경량 웹 프레임워크
- **OpenAI API**: GPT-3.5-turbo 및 text-embedding-3-large
- **Python 3.8+**: 최신 Python 기능 활용
- **Werkzeug**: 파일 업로드 및 보안 처리

### 프론트엔드
- **HTML5**: 시맨틱 마크업
- **CSS3**: CSS 변수 활용, 모던한 반응형 디자인
- **JavaScript**: ES6+ 문법, Fetch API 활용
- **육군 브랜딩**: 공식 로고 및 색상 체계

### 데이터 처리
- **로컬 파일 시스템**: 안전한 문서 저장
- **JSON 메타데이터**: 파일 정보 및 임베딩 상태 관리
- **Pickle**: 벡터 데이터 직렬화

## 🚀 설치 및 실행

### 1. 환경 요구사항
- Python 3.8 이상
- OpenAI API 키
- 최소 2GB RAM (대용량 문서 처리 시 권장)

### 2. 설치 과정

```bash
# 저장소 클론
git clone [repository-url]
cd chatbot

# 가상환경 생성 (권장)
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 의존성 설치
pip install -r requirements.txt
```

### 3. 환경 설정

```bash
# local_config.py 실행하여 환경 변수 설정
python local_config.py
```

또는 `.env` 파일 생성:
```env
OPENAI_API_KEY=your_actual_openai_api_key
```

### 4. 애플리케이션 실행

```bash
python app.py
```

### 5. 접속
- 웹 브라우저에서 `http://localhost:8080` 접속
- **관리자 계정**: `admin` / `admin123`
- **일반 사용자 계정**: `user` / `user123`

## 📁 프로젝트 구조

```
chatbot/
├── app.py                  # 메인 Flask 애플리케이션
├── core/                   # 핵심 모듈
│   ├── __init__.py        # 모듈 초기화
│   ├── rag.py             # RAG 시스템 핵심 로직
│   └── storage.py         # 로컬 파일 저장소 관리
├── templates/              # HTML 템플릿
│   ├── base.html          # 기본 레이아웃 (네비게이션)
│   ├── index.html         # 메인 페이지 (질문하기)
│   ├── login.html         # 로그인 페이지
│   ├── admin.html         # 관리자 대시보드
│   └── error.html         # 오류 페이지
├── static/                 # 정적 파일
│   ├── css/
│   │   └── style.css      # 메인 스타일시트
│   ├── js/
│   │   └── script.js      # 클라이언트 스크립트
│   └── images/
│       ├── army-logo.png   # 육군 공식 로고
│       └── logo.png        # 챗봇 로고
├── local_storage/          # 로컬 저장소
│   ├── documents/         # 업로드된 문서 파일들
│   ├── files_metadata.json # 파일 메타데이터
│   └── vector_store.pkl   # 벡터 데이터베이스
├── requirements.txt        # Python 의존성
├── local_config.py        # 로컬 환경 설정
└── README.md              # 프로젝트 문서
```

## 🔧 주요 기능 상세

### 📤 파일 업로드 및 임베딩
- **드래그 앤 드롭**: 직관적인 파일 업로드
- **자동 임베딩**: 업로드 후 즉시 임베딩 처리
- **진행률 표시**: 업로드 진행 상황을 퍼센트로 표시
- **상태 관리**: 임베딩 완료/대기 상태 실시간 업데이트

### 🔍 문서 검색 및 질의응답
- **자연어 질문**: 한국어로 자유롭게 질문
- **문맥 기반 응답**: 업로드된 문서 내용 기반 정확한 답변
- **실시간 처리**: 빠른 응답 속도

### 🛠 관리자 기능
- **통합 대시보드**: 시스템 상태, 문서 현황, 벡터 DB 정보
- **파일 관리**: 개별/전체 파일 삭제
- **임베딩 관리**: 선택적 임베딩, 전체 임베딩
- **시스템 모니터링**: 실시간 상태 확인

## 📊 API 엔드포인트

### 인증
- `POST /login` - 사용자 로그인
- `GET /logout` - 사용자 로그아웃

### 파일 관리
- `POST /api/upload-and-embed` - 파일 업로드 및 임베딩
- `GET /api/files` - 업로드된 파일 목록 조회
- `DELETE /api/files/<filename>` - 개별 파일 삭제

### 관리자 전용
- `POST /api/admin/delete-all` - 전체 파일 삭제
- `POST /api/admin/rebuild` - 전체 임베딩 재구성
- `POST /api/admin/embed-selected` - 선택된 파일 임베딩
- `GET /api/admin/document-coverage` - 문서 커버리지 정보

### 시스템
- `GET /api/status` - 시스템 상태 확인

## 🎨 사용자 인터페이스

### 메인 페이지
- **질문하기**: 문서에 대한 질문 입력
- **파일 목록**: 업로드된 파일 현황

### 관리자 대시보드
- **시스템 상태**: OpenAI 연결 상태, 벡터 DB 상태
- **문서 현황**: 전체/완료/대기 문서 수
- **벡터 DB**: 총 벡터 수, 차원, 저장소 크기
- **파일 업로드**: 드래그 앤 드롭 영역
- **파일 관리**: 업로드된 파일 목록 및 관리

## 🔒 보안 및 권한

### 인증 시스템
- **세션 기반**: Flask 세션을 통한 사용자 인증
- **비밀번호 보호**: 안전한 비밀번호 저장

### 권한 관리
- **일반 사용자**: 질문하기, 파일 목록 조회만 가능
- **관리자**: 모든 기능 접근 가능

### 파일 보안
- **파일 검증**: 허용된 확장자만 업로드 가능
- **크기 제한**: 최대 50MB 파일 크기 제한
- **안전한 파일명**: 보안을 위한 파일명 변환

## 📈 성능 및 최적화

### 임베딩 처리
- **청크 기반**: 효율적인 문서 분할
- **배치 처리**: 대용량 파일 안전 처리
- **상태 관리**: 실시간 임베딩 상태 추적

### 검색 성능
- **벡터 인덱싱**: 빠른 유사도 검색
- **메모리 효율성**: 최적화된 데이터 구조

## 🐛 문제 해결

### 일반적인 문제

1. **OpenAI API 오류**:
   - API 키 확인
   - API 할당량 확인
   - 네트워크 연결 상태 확인

2. **파일 업로드 실패**:
   - 파일 크기 제한 확인 (50MB)
   - 지원 형식 확인 (PDF, DOCX, TXT)
   - 저장소 권한 확인

3. **임베딩 실패**:
   - OpenAI API 상태 확인
   - 문서 형식 및 내용 확인
   - 메모리 사용량 확인

### 로그 확인

```bash
# 애플리케이션 로그 확인
python app.py

# 브라우저 개발자 도구에서 콘솔 로그 확인
```

## 🔄 업데이트 및 유지보수

### 정기 점검
- **API 키 갱신**: OpenAI API 키 정기 확인
- **저장소 정리**: 불필요한 파일 정리
- **성능 모니터링**: 응답 속도 및 메모리 사용량 확인

### 백업
- **벡터 DB**: `vector_store.pkl` 파일 정기 백업
- **메타데이터**: `files_metadata.json` 파일 백업
- **문서 파일**: 중요 문서 별도 백업

## 📝 개발 가이드

### 새로운 기능 추가

1. **기능 설계**: 요구사항 분석 및 설계
2. **코드 구현**: 모듈화된 구조에 맞춰 구현
3. **테스트**: 기능 테스트 및 통합 테스트
4. **문서화**: README 및 코드 주석 업데이트

### 코드 스타일

- **Python**: PEP 8 준수, 명확한 변수명
- **HTML**: 시맨틱 마크업, 접근성 고려
- **CSS**: CSS 변수 활용, 일관된 네이밍
- **JavaScript**: ES6+ 문법, 함수형 프로그래밍

## 🎯 향후 계획

### 단기 계획
- [ ] 사용자 관리 시스템 개선
- [ ] 파일 형식 지원 확대
- [ ] 성능 최적화

### 장기 계획
- [ ] 클라우드 배포 지원
- [ ] 다국어 지원
- [ ] 고급 분석 기능

## 📄 라이선스

이 프로젝트는 육군 군수사령부 내부 사용을 위한 프로젝트입니다.

## 🤝 기여

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Create a Pull Request

---

**현재 상태**: 프로덕션 준비 완료 ✅  
**마지막 업데이트**: 2025-09-04  
**버전**: 2.1.0 (통합 대시보드 및 선택적 임베딩)  
**담당**: 육군 군수사령부 정보체계과